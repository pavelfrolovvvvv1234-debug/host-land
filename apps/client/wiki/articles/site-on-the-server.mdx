# Site on the Server: Complete Deployment and Configuration Guide

This guide covers deploying and configuring websites on Linux servers, including web server configuration, domain setup, SSL certificate installation, database configuration, and best practices for production deployments.

## Definition and Overview

Deploying a **website on a server** involves configuring a web server (nginx or Apache), setting up domain names, installing SSL certificates, configuring databases, and optimizing performance for production use. This guide provides step-by-step instructions for deploying websites on Linux servers.

Key components:

- **Web server**: nginx or Apache web server for serving HTTP/HTTPS requests.
- **Domain configuration**: DNS records and domain name configuration.
- **SSL certificates**: HTTPS encryption using Let's Encrypt or commercial certificates.
- **Database**: MySQL/MariaDB, PostgreSQL, or MongoDB for application data.
- **PHP/Python/Node.js**: Application runtime environments.
- **Security**: Firewall configuration, access control, and security best practices.

## Web Server Configuration

### nginx Configuration

**Installing nginx**:

```bash
# Ubuntu/Debian
sudo apt update
sudo apt install nginx

# CentOS/Rocky Linux
sudo yum install nginx
# or
sudo dnf install nginx
```

**Basic nginx configuration**:

Create a configuration file for your domain:

```bash
sudo nano /etc/nginx/sites-available/example.com
```

Add the following configuration:

```nginx
server {
    listen 80;
    server_name example.com www.example.com;
    root /var/www/example.com;
    index index.html index.php;

    location / {
        try_files $uri $uri/ =404;
    }

    location ~ \.php$ {
        fastcgi_pass unix:/var/run/php/php8.1-fpm.sock;
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        include fastcgi_params;
    }
}
```

**Enable site**:

```bash
sudo ln -s /etc/nginx/sites-available/example.com /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx
```

### Apache Configuration

**Installing Apache**:

```bash
# Ubuntu/Debian
sudo apt update
sudo apt install apache2

# CentOS/Rocky Linux
sudo yum install httpd
# or
sudo dnf install httpd
```

**Basic Apache configuration**:

Create a configuration file for your domain:

```bash
sudo nano /etc/apache2/sites-available/example.com.conf
```

Add the following configuration:

```apache
<VirtualHost *:80>
    ServerName example.com
    ServerAlias www.example.com
    DocumentRoot /var/www/example.com

    <Directory /var/www/example.com>
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>

    ErrorLog ${APACHE_LOG_DIR}/example.com_error.log
    CustomLog ${APACHE_LOG_DIR}/example.com_access.log combined
</VirtualHost>
```

**Enable site**:

```bash
sudo a2ensite example.com.conf
sudo apache2ctl configtest
sudo systemctl reload apache2
```

## Domain Configuration

### DNS Records

**A record** (IPv4):

```
example.com.    300  IN  A      192.0.2.1
www.example.com. 300  IN  A      192.0.2.1
```

**AAAA record** (IPv6):

```
example.com.    300  IN  AAAA  2001:db8::1
www.example.com. 300  IN  AAAA  2001:db8::1
```

**CNAME record**:

```
www.example.com. 300  IN  CNAME example.com.
```

### Domain Verification

**Check DNS propagation**:

```bash
dig example.com
dig www.example.com
nslookup example.com
```

**Test website access**:

```bash
curl -I http://example.com
curl -I https://example.com
```

## SSL Certificate Installation

### Let's Encrypt SSL

**Installing Certbot**:

```bash
# Ubuntu/Debian
sudo apt install certbot python3-certbot-nginx
# or
sudo apt install certbot python3-certbot-apache

# CentOS/Rocky Linux
sudo yum install certbot python3-certbot-nginx
# or
sudo yum install certbot python3-certbot-apache
```

**Obtaining SSL certificate** (nginx):

```bash
sudo certbot --nginx -d example.com -d www.example.com
```

**Obtaining SSL certificate** (Apache):

```bash
sudo certbot --apache -d example.com -d www.example.com
```

**Automatic renewal**:

```bash
# Test renewal
sudo certbot renew --dry-run

# Certbot automatically renews certificates via systemd timer
sudo systemctl status certbot.timer
```

### Commercial SSL Certificates

**Installing commercial SSL certificate** (nginx):

1. Upload certificate files to server:
   - Certificate file: `example.com.crt`
   - Private key: `example.com.key`
   - CA bundle: `ca-bundle.crt`

2. Update nginx configuration:

```nginx
server {
    listen 443 ssl http2;
    server_name example.com www.example.com;
    root /var/www/example.com;
    index index.html index.php;

    ssl_certificate /etc/ssl/certs/example.com.crt;
    ssl_certificate_key /etc/ssl/private/example.com.key;
    ssl_trusted_certificate /etc/ssl/certs/ca-bundle.crt;

    # SSL configuration
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;
    ssl_prefer_server_ciphers on;

    location / {
        try_files $uri $uri/ =404;
    }
}

server {
    listen 80;
    server_name example.com www.example.com;
    return 301 https://$server_name$request_uri;
}
```

3. Reload nginx:

```bash
sudo nginx -t
sudo systemctl reload nginx
```

## Database Configuration

### MySQL/MariaDB

**Installing MySQL/MariaDB**:

```bash
# Ubuntu/Debian
sudo apt install mysql-server
# or
sudo apt install mariadb-server

# CentOS/Rocky Linux
sudo yum install mysql-server
# or
sudo yum install mariadb-server
```

**Creating database and user**:

```bash
sudo mysql -u root -p
```

```sql
CREATE DATABASE example_db;
CREATE USER 'example_user'@'localhost' IDENTIFIED BY 'strong_password';
GRANT ALL PRIVILEGES ON example_db.* TO 'example_user'@'localhost';
FLUSH PRIVILEGES;
EXIT;
```

**Connecting to database**:

```bash
mysql -u example_user -p example_db
```

### PostgreSQL

**Installing PostgreSQL**:

```bash
# Ubuntu/Debian
sudo apt install postgresql postgresql-contrib

# CentOS/Rocky Linux
sudo yum install postgresql-server postgresql-contrib
```

**Creating database and user**:

```bash
sudo -u postgres psql
```

```sql
CREATE DATABASE example_db;
CREATE USER example_user WITH PASSWORD 'strong_password';
GRANT ALL PRIVILEGES ON DATABASE example_db TO example_user;
\q
```

**Connecting to database**:

```bash
psql -U example_user -d example_db
```

## PHP Configuration

### Installing PHP

**Installing PHP and extensions**:

```bash
# Ubuntu/Debian
sudo apt install php8.1 php8.1-fpm php8.1-mysql php8.1-xml php8.1-mbstring php8.1-curl

# CentOS/Rocky Linux
sudo yum install php81 php81-php-fpm php81-php-mysqlnd php81-php-xml php81-php-mbstring php81-php-curl
```

**PHP-FPM configuration**:

```bash
sudo nano /etc/php/8.1/fpm/php.ini
```

Common settings:

```ini
memory_limit = 256M
upload_max_filesize = 64M
post_max_size = 64M
max_execution_time = 300
```

**Restart PHP-FPM**:

```bash
sudo systemctl restart php8.1-fpm
```

## Security Best Practices

### Firewall Configuration

**UFW (Ubuntu/Debian)**:

```bash
sudo ufw allow 22/tcp
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
sudo ufw enable
```

**firewalld (CentOS/Rocky Linux)**:

```bash
sudo firewall-cmd --permanent --add-service=ssh
sudo firewall-cmd --permanent --add-service=http
sudo firewall-cmd --permanent --add-service=https
sudo firewall-cmd --reload
```

### Access Control

**SSH security**:

```bash
sudo nano /etc/ssh/sshd_config
```

Recommended settings:

```
PermitRootLogin no
PasswordAuthentication no
PubkeyAuthentication yes
```

**Restart SSH**:

```bash
sudo systemctl restart sshd
```

### File Permissions

**Setting correct permissions**:

```bash
# Web root directory
sudo chown -R www-data:www-data /var/www/example.com
sudo chmod -R 755 /var/www/example.com

# Files
sudo find /var/www/example.com -type f -exec chmod 644 {} \;

# Directories
sudo find /var/www/example.com -type d -exec chmod 755 {} \;
```

## Performance Optimization

### Caching

**nginx caching**:

```nginx
proxy_cache_path /var/cache/nginx levels=1:2 keys_zone=my_cache:10m max_size=10g inactive=60m;

server {
    location / {
        proxy_cache my_cache;
        proxy_cache_valid 200 60m;
        proxy_cache_use_stale error timeout updating http_500 http_502 http_503 http_504;
    }
}
```

**PHP OPcache**:

```ini
opcache.enable=1
opcache.memory_consumption=128
opcache.interned_strings_buffer=8
opcache.max_accelerated_files=4000
opcache.revalidate_freq=2
```

### Compression

**gzip compression** (nginx):

```nginx
gzip on;
gzip_vary on;
gzip_proxied any;
gzip_comp_level 6;
gzip_types text/plain text/css text/xml text/javascript application/json application/javascript application/xml+rss;
```

## Troubleshooting

### Common Issues

**Website not loading**:

```bash
# Check web server status
sudo systemctl status nginx
# or
sudo systemctl status apache2

# Check web server logs
sudo tail -f /var/log/nginx/error.log
# or
sudo tail -f /var/log/apache2/error.log

# Check configuration
sudo nginx -t
# or
sudo apache2ctl configtest
```

**SSL certificate issues**:

```bash
# Check certificate expiration
sudo certbot certificates

# Test SSL configuration
openssl s_client -connect example.com:443

# Renew certificate manually
sudo certbot renew
```

**Database connection issues**:

```bash
# Check database service
sudo systemctl status mysql
# or
sudo systemctl status postgresql

# Test database connection
mysql -u example_user -p example_db
# or
psql -U example_user -d example_db
```

## FAQ

### What web server should I use?

Both nginx and Apache are excellent choices. nginx is known for high performance and low memory usage, while Apache has more features and modules.

### How do I deploy a WordPress site?

1. Install WordPress files in web root directory.
2. Create MySQL database and user.
3. Configure `wp-config.php` with database credentials.
4. Complete WordPress installation via web interface.

### How do I deploy a Node.js application?

1. Install Node.js and npm.
2. Install PM2 process manager.
3. Configure nginx as reverse proxy.
4. Start application with PM2.

### How do I deploy a Python application?

1. Install Python and virtual environment.
2. Install application dependencies.
3. Configure WSGI server (Gunicorn, uWSGI).
4. Configure nginx as reverse proxy.

### How do I backup my website?

```bash
# Backup files
tar -czf website_backup_$(date +%Y%m%d).tar.gz /var/www/example.com

# Backup database
mysqldump -u example_user -p example_db > database_backup_$(date +%Y%m%d).sql
```

### How do I monitor website performance?

- Use monitoring tools (Nagios, Zabbix, Prometheus).
- Monitor server resources (CPU, RAM, disk, network).
- Monitor website uptime and response times.
- Analyze web server logs.

## Related Articles

- [FastPanel on Server](/wiki/articles/fastpanel-on-server)
- [ISPManager on Server](/wiki/articles/ispmanager-on-the-server)
- [Virtual Servers](/wiki/articles/virtual-servers)
- [Dedicated Servers](/wiki/articles/dedicated-servers)
